name: Daily CB Crawler

on:
  schedule:
    # 每天 UTC 14:00 執行 (等於台灣時間 22:00)
    - cron: '0 14 * * *'
  workflow_dispatch: # 允許手動點擊按鈕測試

jobs:
  run-crawler:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code (下載程式碼)
        uses: actions/checkout@v3

      - name: Set up Python (設定 Python 環境)
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies (安裝套件)
        run: |
          pip install requests beautifulsoup4 google-api-python-client google-auth-oauthlib selenium webdriver-manager

      - name: Run Crawler (執行爬蟲)
        env:
          # 將 Secrets 注入到環境變數
          GOOGLE_CREDENTIALS_JSON: ${{ secrets.GOOGLE_CREDENTIALS_JSON }}
          CALENDAR_ID: ${{ secrets.CALENDAR_ID }}
        run: python main.py